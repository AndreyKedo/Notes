

# Архитектура Docker

*Docker* использует *клиент-серверную архитектуру*. 

Клиент и сервер общаются между собой при помощи REST API поверх сокетов и сетевого интерфейса.

**Docker-клиент** (Docker client) использует CLI-команды, чтобы общаться с *Docker daemon*, выступающим в роли *сервера*.
```js
// CLI-команды
docker run
docker build
docker pull
```
**Docker daemon** собирает, запускает и раздаёт (distribute) контейнеры.

**Образ** (Image) - доступный только для чтения шаблон с инструкциями о том, как запустить какой-то Docker-контейнер. 

Один образ может расширять другой.

Для создания образа необходимо создать *Dockerfile* для определения шагов, необходимых для создания образа и запустить этот файл. Каждая инструкция в Dockerfile создаёт новый слой (layer) в образе. Когда Dockerfile изменяется и образ пересобирается (rebuild), пересобираются только изменённые слои.

Образы хранятся в Docker-реестре (Docker registry). Одним из таких является Docker Hub - публичный реестр, который используется по умолчанию.
```js
// загрузить image из реестра
docker pull <image>
// загрузить image в реестр
docker push <image>
```

**Контейнер** (Container) - запускаемый экземпляр образа. Его можно создавать, запускать, останавливать, перемещать и удалять при помощи Docker API или CLI.

По умолчанию контейнер достаточно хорошо изолирован от маширы-хоста, но это можно контролировать, передавая в контейнер всё необходимое.

# Хранение данных

## Volume

**Volume** - предпочитительный механизм для хранения данных (persisting data), используемых в Docker-контейнере.

### Почему следует использовать Volume

Volume хранится вне контейнера. Поэтому он не увеличивает размер контейнера, а также не подвержен влиянию жизненного цикла контейнера.
